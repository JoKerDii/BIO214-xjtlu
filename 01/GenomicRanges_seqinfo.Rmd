---
Di Zhen

GenomicRanges_seqinfo_Note
---

```{r dependencies, warning=FALSE, message=FALSE}
library(GenomeInfoDb)
library(GenomicRanges)
```

## Overview

The `GRanges` class contains `seqinfo` information about the length and the names of the chromosomes. 

`seqinfo` and `seqlevels`.


## Drop and keep seqlevels

To remove `seqlevels` from a `GRanges` object.

```{r seqlevelsForce}
gr <- GRanges(seqnames = c("chr1", "chr2"),
              ranges = IRanges(start = 1:2, end = 4:5))
gr
seqlevels(gr, pruning.mode="coarse") <- "chr1"
gr
```

In `Biocpkg("GenomeInfoDb")` (loaded when you load `Biocpkg("GenomicRanges")`), `dropSeqlevels()` and `keepSeqlevels()`. 

```{r dropSeqlevels}

seqlevels <- c("chr2RHet", "chr4", "chrUextra", "chrYHet",
               "chrM", "chrXHet", "chr2LHet", "chrU",
               "chr3L", "chr3R", "chr2R", "chrX")
sortSeqlevels(seqlevels)

gr <- GRanges()
seqlevels(gr) <- seqlevels

gr <- dropSeqlevels(gr, "chr3L")
seqlevels(gr)
gr <- keepSeqlevels(gr, "chr4") # only keep
seqlevels(gr)
```

```{r}
gr <- GRanges(seqnames = c("chr1", "chr2"),
              ranges = IRanges(start = 1:2, end = 4:5))
dropSeqlevels(gr, "chr1", pruning.mode="coarse")
keepSeqlevels(gr, "chr2", pruning.mode="coarse") # only keep
```

Get rid of weird looking chromosome names with `keepStandardChromosomes()`.
```{r keepStandard}
gr <- GRanges(seqnames = c("chr1", "chrU345"),
              ranges = IRanges(start = 1:2, end = 4:5))
keepStandardChromosomes(gr,pruning.mode="coarse")
```

## Changing style

Different online resources uses different naming convention for chromosomes.

```{r GRanges}
gr <- GRanges(seqnames = "chr1", ranges = IRanges(start = 1:2, width = 2))
```

Remap
```{r seqStyle}
newStyle <- mapSeqlevels(seqlevels(gr), "NCBI")
gr <- renameSeqlevels(gr, newStyle)
gr # note that the seqnames is "1" but not "chr1"
```

The `Biocpkg("GenomeInfoDb")` also contains information for dropping / keeping various classes of chromosomes.

## Using information from BSgenome packages

`BSgenome` packages contains `seqinfo` on their genome objects containing `seqlengths` and other information.  

